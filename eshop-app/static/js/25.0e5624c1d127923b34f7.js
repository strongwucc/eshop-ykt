webpackJsonp([25],{FVkU:function(t,e){},ZM25:function(t,e){},vyE0:function(t,e,s){"use strict";var o=s("Dd8w"),i=s.n(o),n=s("NYxO"),a={name:"floating",data:function(){return{featuresViewVisible:!1}},props:{appending:{type:Boolean,default:!1}},computed:i()({},Object(n.c)({userCart:function(t){return t.user.user_cart},deskId:function(t){return t.common.common_data.desk_info.desk_id},storeId:function(t){return t.common.common_data.store_info.store_id},people:function(t){return t.common.common_data.desk_info.info.people}}),{totalNum:function(){var t=0;return this.userCart.goods_list&&this.userCart.goods_list.forEach(function(e){t+=parseInt(e.num)}),t},totalPrice:function(){var t=0,e=0;if(this.userCart.goods_list&&this.userCart.goods_list.forEach(function(e){t+=e.num*e.price}),this.userCart.adjunct_list){var s=void 0;for(s in this.userCart.adjunct_list)this.userCart.adjunct_list[s].forEach(function(t){t.forEach(function(t){e+=t.num*t.price})})}return this.NP.round(t+e,2)}}),created:function(){},methods:{featuresViewtoggle:function(){this.featuresViewVisible=!this.featuresViewVisible},goShopCart:function(){this.appending?this.$router.push("/shop_cart?appending=1"):this.$router.push("/shop_cart")}}},r={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"floating-box"},[o("div",{staticClass:"features"},[o("div",{staticClass:"title",on:{click:t.featuresViewtoggle}},[o("img",{staticClass:"icon",attrs:{src:s("DHIp")}}),t._v("\n      功能\n    ")]),t._v(" "),o("ul",{directives:[{name:"show",rawName:"v-show",value:t.featuresViewVisible,expression:"featuresViewVisible"}],staticClass:"list"},[o("li",{on:{click:function(e){t.$router.push("/center")}}},[t._v("会员中心")]),t._v(" "),o("li",{on:{click:function(e){t.$router.push("/my_order/dine")}}},[t._v("我的订单")]),t._v(" "),o("li",{on:{click:function(e){t.$router.push("/my_coupons")}}},[t._v("我的优惠券")]),t._v(" "),o("li",{on:{click:function(e){t.$router.push("/shop_cart")}}},[t._v("购物车")]),t._v(" "),t.appending?o("li",{on:{click:function(e){t.$router.push({name:"confirm_pay",params:{deskId:t.deskId}})}}},[t._v("结账")]):t._e()])]),t._v(" "),o("div",{staticClass:"shopping-cart",on:{click:t.goShopCart}},[o("div",{ref:"cartContainer",staticClass:"circle"},[t.totalNum?o("div",{staticClass:"num"},[t._v(t._s(t.totalNum))]):t._e()]),t._v(" "),o("p",{staticClass:"total"},[t._v("￥"),o("span",[t._v(t._s(t._f("formatActualMoney")(t.totalPrice)))])])])])},staticRenderFns:[]};var c=s("VU/8")(a,r,!1,function(t){s("ZM25")},"data-v-06a875d0",null);e.a=c.exports},"z9/y":function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=s("Gu7T"),i=s.n(o),n=s("c/Tr"),a=s.n(n),r=s("Dd8w"),c=s.n(r),l=s("GQaK"),d=s("HR77"),h=s("vyE0"),u=s("MYSA"),f=s("LV3v"),_=s("NYxO"),p=document.querySelector("html").getAttribute("data-dpr"),m={name:"home",data:function(){return{appending:!1,windowHeight:0,standardLength:0,showSimulationBtn:!0,showStoreInfo:!1,showLoading:!0,storeId:this.$route.params.storeId,deskId:this.$route.params.deskId,peopleNum:this.$route.params.peopleNum,directlyAdd:0,operation:!0,blockSearhIocn:!0,graySearhIocn:!1,dishes:[],bodyScroll:!0,sideScroll:!1,mainScroll:!1,mainReachTop:!0,sideReachTop:!0,jsScroll:!1,featuresViewVisible:!1,goodsTitleListTop:[],goodsListTop:[],mainLengthDifference:0,catIndex:0,catIndexChange:!0,showMoveDot:[],receiveInCart:!1,categoryNum:[],totalPrice:0,cartFoodList:[],specsVisible:!1,specificationInfo:[],goodsDetailVisible:!1,goodsPic:"",storeInf:{store_log:"",desk:{},store_name:"",open_time:""},gettingGoodsDetail:!1,deskStatusTimer:null}},components:{Goods:d.a,Floating:h.a,StoreInfo:u.a,GoodsSpecification:f.a},watch:{bodyScroll:function(t){t?(this._bodyScroll.enable(),this._bodyScroll.scrollTo(0,0,400)):this._bodyScroll.disable()},sideScroll:function(t){t?(this._sideScroll.enable(),this.touchStartX&&this.touchStartX<this.elementsStyle.SIDE_WIDTH&&!this.jsScroll&&document.querySelector(".side").offsetHeight<document.querySelector(".side").children[0].offsetHeight&&this._sideScroll.scrollTo(0,-200*p,1e3)):this._sideScroll.disable()},catIndex:function(t){var e=this.$refs.sideScrollBox.offsetHeight;this.goodsTitleListTop[t]>e&&this._sideScroll.scrollTo(0,this.goodsTitleListTop[t]-e,200)},showLoading:function(t){var e=this;t||this.$nextTick(function(){e.getdishesHeight()})}},beforeDestroy:function(){clearInterval(this.deskStatusTimer)},beforeRouteEnter:function(t,e,s){s(function(t){"people_num"!==e.name&&t.getStoreInfo()})},created:function(){this.elementsStyle=null,this.$store.state.common.common_data.store_info&&(this.storeInf=this.$store.state.common.common_data.store_info),this.$route.query.appending?this.appending=!0:this.deskStatusTimer=setInterval(this.deskStatus,5e3)},mounted:function(){this.axiosAll()},computed:c()({},Object(_.c)({userCart:function(t){return t.user.user_cart},deskInfo:function(t){return t.common.common_data.desk_info}})),methods:c()({},Object(_.b)(["set_user_cart","set_common_data_store_info","set_common_data_desk_info"]),{getStoreInfo:function(){var t=this;this.$http.post(this.API.seller.store_info,{store_id:this.storeId,desk_id:this.deskId}).then(function(e){"0000"===e.return_code?(t.storeInfo=e.data.store,t.set_user_cart(e.data.user_cart),e.data.store&&(t.set_common_data_store_info(e.data.store),t.storeInf=e.data.store),e.data.desk&&t.set_common_data_desk_info(e.data.desk),"0"==e.data.desk.status?t.$router.push("/people_num/"+t.storeId+"/"+t.deskId):t.appending||("2"==e.data.desk.status?t.$router.push("/confirm_pay/"+t.deskId):"3"==e.data.desk.status?t.$router.push("/merchant_confirm/"+t.deskId):"4"==e.data.desk.status||"5"==e.data.desk.status?t.$router.push("/order_detail/dine_detail/"+e.data.desk.info.order_id):"6"==e.data.desk.status&&t.$router.push("/order_detail/dine_detail/"+e.data.desk.info.order_id))):t.$myToast(e.return_msg)})},goSearch:function(){this.$router.push({name:"search",params:{storeId:this.storeId,deskId:this.deskId,peopleNum:this.peopleNum}})},initDishes:function(){return this.$http.post(this.API.seller.store_goods,{store_id:this.storeId})},axiosAll:function(){var t=this;this.$myLoading.open({text:"加载中...",spinnerType:"fading-circle"}),this.$http.all([this.initDishes()]).then(function(e){if("0000"===e[0].return_code){t.dishes=e[0].data.list;var s=[];t.dishes.forEach(function(t){s.push(t.cat_id)}),t.catIdList=s,t.$nextTick(function(){t._getStyle(),t._setStyle(),t._bodyScrollEvent(),t._pageTouchListener()}),t.showLoading=!1,t.$myLoading.close()}else t.$myToast(e[0].return_msg)})},changeCategroyNum:function(t){this.categoryNum=t},featuresViewtoggle:function(){this.featuresViewVisible=!this.featuresViewVisible},showSpecsList:function(t){var e=this;if(this.gettingGoodsDetail)return!1;this.gettingGoodsDetail=!0,this.$http.post(this.API.seller.store_goods_detail,{store_id:this.storeId,product_id:t.product.product_id}).then(function(t){e.gettingGoodsDetail=!1,"0000"==t.return_code&&(e.specsVisible=!0,e.specificationInfo=t.data.detail)})},closeSpecsList:function(){this.specsVisible=!1},showGoodsDetail:function(t){this.goodsPic=t,this.goodsDetailVisible=!0},getdishesHeight:function(){var t=this,e=this.$refs.mainScrollBox,s=this.$refs.sideScrollBox,o=a()(e.children[0].children),i=a()(s.children[0].children);this.mainLengthDifference=e.children[0].offsetHeight-e.offsetHeight,o.forEach(function(e,s){t.goodsListTop[s]=e.offsetTop}),i.forEach(function(e,o,i){o!==i.length-1?t.goodsTitleListTop[o]=i[o+1].offsetTop:t.goodsTitleListTop[o]=s.children[0].offsetHeight}),this._sideScrollEvent(),this._mainScrollEvent()},chooseMenu:function(t){this.catIndex=t,this.catIndexChange=!1,this.jsScroll=!0,this._bodyScroll.scrollTo(0,-this.elementsStyle.SCROLL_HEIGHT,400),this._mainScroll.scrollTo(0,-this.goodsListTop[this.catIndex],400)},showMoveDotFun:function(t,e,s){this.showMoveDot=[].concat(i()(this.showMoveDot),i()(t)),this.elLeft=e,this.elBottom=s},beforeEnter:function(t){t.style.transform="translate3d(0,"+(this.elBottom-this.windowHeight+.4*this.standardLength)+"px,0)",t.children[0].style.transform="translate3d("+(this.elLeft-3*this.standardLength)+"px,0,0)",t.children[0].style.opacity=0},afterEnter:function(t){var e=this;t.style.transform="translate3d(0,0,0)",t.children[0].style.transform="translate3d(0,0,0)",t.style.transition="transform .5s cubic-bezier(0.3, -0.25, 0.7, -0.15)",t.children[0].style.transition="transform .5s linear",this.showMoveDot=this.showMoveDot.map(function(t){return!1}),t.children[0].style.opacity=1,t.children[0].addEventListener("transitionend",function(){e.listenInCart()},!!this.$passiveSupported&&{passive:!0}),t.children[0].addEventListener("webkitAnimationEnd",function(){e.listenInCart()},!!this.$passiveSupported&&{passive:!0})},listenInCart:function(){this.receiveInCart||(this.receiveInCart=!0)},_getStyle:function(){document.getElementById("app").style.height=window.innerHeight+"px";var t=this.$refs.banner,e=this.$refs.storeInfo,s=document.querySelector(".search-icon"),o=document.querySelector(".table-num"),i=document.querySelector(".side");this.windowHeight=window.innerHeight,this.standardLength=this.$refs._100px.offsetWidth,this.elementsStyle={REDUCE_HEIGHT:t.offsetHeight/2+o.offsetHeight,SCROLL_HEIGHT:t.offsetHeight/2+e.offsetHeight,SEARCHICON_TRANSLATE_Y:(t.offsetHeight/2-s.offsetHeight)/2+t.offsetHeight/2+s.offsetHeight/2,SEARCHICON_TRANSLATE_X:(window.innerWidth-2*s.offsetWidth-220*p)/2,SEARCHICON_INIT_WIDTH:s.offsetWidth,SEARCH_ADD_WIDTH:220*p,SEARCHICON_INIT_RADIUS:15*p,SEARCHICON_ADD_RADIUS:11*p,SEARCHICON_GRAY:115*p,SIDE_WIDTH:i.offsetWidth,SIDE_HEIGHT:i.offsetHeight,SIDE_UL_HEIGHT:i.children[0].offsetHeight}},_setStyle:function(){this.$refs._wrapper.style.paddingTop=this.$refs.banner.offsetHeight+this.$refs.storeInfo.offsetHeight+"px",this.$refs.overview.style.height=window.innerHeight-this.elementsStyle.REDUCE_HEIGHT+"px"},_bodyScrollEvent:function(){var t=this;this._bodyScroll=new l.a(this.$refs.scrollWrapper,{scrollY:!0,click:!0,bounce:!1,probeType:3,flickLimitDistance:this.standardLength/2});var e=this.$refs.logo,s=this.$refs.searchIcon,o=this.elementsStyle;this._bodyScroll.on("scroll",function(i){var n=-i.y.toFixed(1),a=(o.SCROLL_HEIGHT-n)/o.SCROLL_HEIGHT;e.style.opacity=a,e.style.transform="scale("+a+")",i.y<-5?t.blockSearhIocn=!1:t.blockSearhIocn=!0,i.y<-o.SEARCHICON_GRAY?t.graySearhIocn=!0:t.graySearhIocn=!1,s.style.transform="translate(-"+(1-a)*o.SEARCHICON_TRANSLATE_X+"px, -"+(1-a)*o.SEARCHICON_TRANSLATE_Y+"px)",s.style.width=(1-a)*o.SEARCH_ADD_WIDTH+o.SEARCHICON_INIT_WIDTH+"px",s.style.borderRadius=o.SEARCHICON_INIT_RADIUS-(1-a)*o.SEARCHICON_ADD_RADIUS+"px"}),this._bodyScroll.on("scrollEnd",function(e){-e.y===o.SCROLL_HEIGHT?(t.bodyScroll=!1,t.showSimulationBtn=!1):t.showSimulationBtn=!0})},_sideScrollEvent:function(){var t=this;this._sideScroll=new l.a(this.$refs.sideScrollBox,{scrollY:!0,click:!0,bounce:!1,probeType:3}),!this.sideScroll&&this._sideScroll.disable(),this._sideScroll.on("scrollEnd",function(e){e.y>=-3?t.sideReachTop=!0:t.sideReachTop=!1})},_mainScrollEvent:function(){var t=this;this._mainScroll=new l.a(this.$refs.mainScrollBox,{scrollY:!0,click:!0,bounce:!1,probeType:3}),this._mainScroll.on("scroll",function(e){t.$refs.sideScrollBox&&t.goodsListTop.forEach(function(s,o){t.catIndexChange&&Math.abs(Math.round(e.y))>=s&&(t.catIndex=o)})}),this._mainScroll.on("scrollEnd",function(e){e.y>=-3?t.mainReachTop=!0:t.mainReachTop=!1,t.catIndexChange=!0})},_pageTouchListener:function(){var t=this;this.$refs.homePage.addEventListener("touchstart",function(e){t.touchStartX=e.touches[0].pageX,t.touchStartY=e.touches[0].pageY},!!this.$passiveSupported&&{passive:!0}),this.$refs.homePage.addEventListener("touchend",function(e){var s=e.changedTouches[0].pageY;!t.bodyScroll&&s-t.touchStartY>50*p&&t.mainReachTop&&(t.bodyScroll=!0)},!!this.$passiveSupported&&{passive:!0})},deskStatus:function(){var t=this;this.deskId&&this.$http.post(this.API.seller.desk_status,{desk_id:this.deskId}).then(function(e){"0000"===e.return_code&&("2"==e.data.status?t.$router.push("/confirm_pay/"+t.deskId):"3"==e.data.status?t.$router.push("/merchant_confirm/"+t.deskId):"4"==e.data.status||"5"==e.data.status?t.$router.push("/order_detail/dine_detail/"+e.data.order_id):"6"==e.data.status&&t.$router.push("/order_detail/dine_detail/"+e.data.order_id))})}})},v={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{ref:"homePage",staticClass:"home-page",style:{visibility:t.showLoading?"hidden":"visible"}},[o("div",{ref:"_100px",staticClass:"_100px"}),t._v(" "),o("div",{staticClass:"fixed-wrapper"},[o("div",{ref:"banner",staticClass:"banner"},[t.storeInf?o("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.storeInf.store_log,expression:"storeInf.store_log"}],ref:"logo",staticClass:"logo"}):o("img",{ref:"logo",staticClass:"logo",attrs:{src:s("Qcae")}}),t._v(" "),o("div",{ref:"searchIcon",staticClass:"search-icon"},[o("img",{directives:[{name:"show",rawName:"v-show",value:t.blockSearhIocn,expression:"blockSearhIocn"}],staticClass:"block-icon",attrs:{src:s("Puz1")}}),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.graySearhIocn,expression:"graySearhIocn"}],staticClass:"scroll-show"},[o("img",{attrs:{src:s("lmx/")}}),t._v(" "),o("span",{style:{visibility:t.graySearhIocn?"visible":"hidden"}},[t._v("有什么想吃的搜一搜")])])])]),t._v(" "),o("div",{ref:"storeInfo",staticClass:"store-info",attrs:{id:"store_info"}},[t.storeInf?o("h3",{staticClass:"store-name"},[t._v("\n        "+t._s(t.storeInf.store_name)+"\n        "),t.operation?o("span",{staticClass:"in-operation"},[t._v("营业中")]):t._e(),t._v(" "),t.operation?t._e():o("span",{staticClass:"resting"},[t._v("暂停营业")])]):t._e(),t._v(" "),o("div",{staticClass:"info01"},[t.storeInf?o("p",{staticClass:"business-hours"},[t._v("\n          营业时间："+t._s(t.storeInf.open_time)+"\n        ")]):t._e(),t._v(" "),t._m(0)])])]),t._v(" "),o("div",{ref:"scrollWrapper",staticClass:"scroll-wrapper"},[o("div",{ref:"_wrapper",staticClass:"wrapper"},[o("div",{directives:[{name:"show",rawName:"v-show",value:t.showSimulationBtn,expression:"showSimulationBtn"}],staticClass:"search-btn",on:{click:t.goSearch}}),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:t.showSimulationBtn,expression:"showSimulationBtn"}],staticClass:"store-info-btn",on:{touchstart:function(e){t.showStoreInfo=!0}}}),t._v(" "),o("div",{directives:[{name:"show",rawName:"v-show",value:!t.showSimulationBtn,expression:"!showSimulationBtn"}],staticClass:"search-faker",on:{click:t.goSearch}}),t._v(" "),o("p",{staticClass:"table-num"},[t.deskInfo?o("span",[t._v("当前："+t._s(t.deskInfo.type_name+" "+t.deskInfo.name))]):t._e()]),t._v(" "),o("div",{ref:"overview",staticClass:"goods-overview"},[o("div",{ref:"sideScrollBox",staticClass:"side scroll-box"},[o("ul",{staticClass:"goods-type-list"},t._l(t.dishes,function(e,i){return o("li",{key:i,staticClass:"type-item",class:{activity_menu:i===t.catIndex},on:{click:function(e){t.chooseMenu(i)}}},[0===i?o("img",{staticClass:"icon",attrs:{src:s("FyJC")}}):t._e(),t._v(" "),o("span",{staticClass:"txt"},[t._v("\n               "+t._s(e.cat_name)+"\n             ")]),t._v(" "),t.userCart.length>0&&void 0!==t.userCart.cat_list[e.cat_id]?o("span",{staticClass:"category-num"},[t._v(t._s(t.userCart.cat_list[e.cat_id]))]):t._e()])}))]),t._v(" "),o("div",{ref:"mainScrollBox",staticClass:"main scroll-box"},[o("ul",{staticClass:"outside-list"},t._l(t.dishes,function(e){return o("li",{staticClass:"outside-item"},[o("h4",{staticClass:"type-name"},[t._v("\n                "+t._s(e.cat_name)+"\n              ")]),t._v(" "),o("goods",{attrs:{items:e.goods},on:{showSpecs:t.showSpecsList,moveInCart:t.listenInCart,showMoveDot:t.showMoveDotFun,showGoodsDetail:t.showGoodsDetail}})],1)}))])])])]),t._v(" "),o("floating",{attrs:{appending:t.appending}}),t._v(" "),o("mt-popup",{attrs:{position:"bottom"},model:{value:t.specsVisible,callback:function(e){t.specsVisible=e},expression:"specsVisible"}},[o("goods-specification",{attrs:{info:t.specificationInfo},on:{closeSpecs:t.closeSpecsList}})],1),t._v(" "),o("mt-popup",{staticClass:"goods-detail-wrapper",attrs:{position:"center","popup-transition":"popup-fade"},model:{value:t.goodsDetailVisible,callback:function(e){t.goodsDetailVisible=e},expression:"goodsDetailVisible"}},[o("div",{staticClass:"goods-detail"},[o("img",{staticClass:"goods-pic",attrs:{src:t.goodsPic}})])]),t._v(" "),o("store-info",{class:{show_info:t.showStoreInfo},attrs:{"store-info":t.storeInf},on:{close:function(e){t.showStoreInfo=!1}}}),t._v(" "),t._l(t.showMoveDot,function(e,s){return o("transition",{key:s,attrs:{appear:""},on:{"after-appear":t.afterEnter,"before-appear":t.beforeEnter}},[e?o("div",{staticClass:"move-dot"},[o("span",{staticClass:"move-liner"})]):t._e()])})],2)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("p",{staticClass:"introduction-btn"},[this._v("\n          商铺信息 >\n          "),e("i",{staticClass:"fa fa-angle-right"})])}]};var g=s("VU/8")(m,v,!1,function(t){s("FVkU")},"data-v-153ccf50",null);e.default=g.exports}});
//# sourceMappingURL=25.0e5624c1d127923b34f7.js.map