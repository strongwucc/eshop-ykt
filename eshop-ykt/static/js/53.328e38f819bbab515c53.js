webpackJsonp([53],{SyNd:function(t,e){},g0Jk:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("j1bm"),o=s("MJLE"),i=s.n(o),n=s("3XNK"),c={name:"use_coupon",data:function(){return{couponCode:this.$route.params.couponCode,barcodeOption:{displayValue:!1,background:"#fff",valid:function(t){}},couponDetail:{},codeTimer:null}},components:{barcode:a.a,back:n.a},created:function(){this.getCouponDetail()},beforeDestroy:function(){clearInterval(this.codeTimer)},methods:{generateQRcode:function(){this.$refs.qrcode.innerHTML="";var t=this.$refs.qrcode.offsetHeight,e=this.$refs.qrcode.offsetWidth,s=(new i.a(document.getElementById("qrcode"),{width:e,height:t,text:this.couponCode}),this);this.codeTimer=setInterval(function(){s.queryCouponStatus()},5e3)},getCouponDetail:function(){var t=this;this.$myLoading.open({text:"加载中...",spinnerType:"fading-circle"}),this.$http.post(this.API.user.coupon_detail,{code:this.couponCode}).then(function(e){if(t.$myLoading.close(),"0000"!==e.return_code)return t.$myToast(e.return_msg),!1;t.couponDetail=e.data,t.generateQRcode()})},queryCouponStatus:function(){var t=this;this.$http.post(this.API.user.coupon_status,{code:this.couponCode}).then(function(e){return"0000"!==e.return_code?(t.$myToast(e.return_msg),clearInterval(t.codeTimer),!1):"0"!==e.data.use_status?(t.$myToast("已使用"),clearInterval(t.codeTimer),setTimeout(function(){t.$router.replace("/my_coupons")},1e3),!1):void 0})}}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"coupon-code-page"},[s("div",{staticStyle:{height:"2px"}}),t._v(" "),t.couponDetail?s("div",{staticClass:"wrapper"},[s("div",{staticClass:"head"},[s("span",{staticClass:"store-name"},[t._v(t._s(t.couponDetail.title))]),t._v(" "),"GIFT"===t.couponDetail.card_type?s("span",{staticClass:"duihuan-icon"},[t._v("兑换券")]):"REDUCE"===t.couponDetail.card_type?s("span",{staticClass:"manjian-icon"},[t._v("满减券")]):"CASH"===t.couponDetail.card_type?s("span",{staticClass:"manjian-icon"},[t._v("代金券")]):"DISCOUNT"===t.couponDetail.card_type?s("span",{staticClass:"zhekou-icon"},[t._v("折扣券")]):t._e()]),t._v(" "),s("div",{staticClass:"value"},[t._v("\n      "+t._s(t.couponDetail.title)+"\n    ")]),t._v(" "),s("p",{staticClass:"use-condition"},[t._v("\n      "+t._s(t.couponDetail.sub_title)+"\n    ")]),t._v(" "),s("div",{staticClass:"barcode"},[s("barcode",{staticStyle:{width:"100%",height:"100%"},attrs:{value:t.couponCode,options:t.barcodeOption}})],1),t._v(" "),s("p",{staticClass:"code-txt"},[t._v(t._s(t.couponCode))]),t._v(" "),s("div",{ref:"qrcode",staticClass:"qrcode",attrs:{id:"qrcode"}}),t._v(" "),s("div",{staticClass:"other-wrapper"},[s("div",{staticClass:"other use-period"},[s("span",{staticClass:"l"},[t._v("使用期限")]),t._v(" "),s("span",{staticClass:"r"},[t._v(t._s(t.couponDetail.validate_time))])]),t._v(" "),s("div",{staticClass:"other applicable-store",on:{click:function(e){t.$router.push("/applicable_store/"+t.couponDetail.cid)}}},[s("span",{staticClass:"l"},[t._v("适用门店")]),t._v(" "),t._m(0)]),t._v(" "),t._m(1)])]):t._e(),t._v(" "),s("back")],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("i",[e("img",{attrs:{src:s("FXWK")}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"other use-notice"},[e("span",{staticClass:"l"},[this._v("使用须知")]),this._v(" "),e("i",[e("img",{attrs:{src:s("FXWK")}})])])}]};var u=s("VU/8")(c,r,!1,function(t){s("SyNd")},"data-v-3e306cf9",null);e.default=u.exports}});
//# sourceMappingURL=53.328e38f819bbab515c53.js.map